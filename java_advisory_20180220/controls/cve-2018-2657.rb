# encoding: utf-8
# copyright: 2018, eNFence GmbH

title 'java_advisory_20180220'

control 'CVE-2018-2657' do
  impact 0.53
  title 'An unspecified vulnerability related to the Java SE, Serialization component could allow an unauthenticated attacker to cause a denial of service resulting in a low availability impact using unknown attack vectors.'
  desc 'Vulnerability in the Java SE, JRockit component of Oracle Java 
        SE (subcomponent: Serialization). Supported versions that are 
        affected are Java SE: 6u171 and 7u161; JRockit: R28.3.16. Easily 
        exploitable vulnerability allows unauthenticated attacker with 
        network access via multiple protocols to compromise Java SE, JRockit. 
        Successful attacks of this vulnerability can result in unauthorized 
        ability to cause a partial denial of service (partial DOS) of Java SE, 
        JRockit. Note: This vulnerability can only be exploited by supplying 
        data to APIs in the specified Component without using Untrusted Java 
        Web Start applications or Untrusted Java applets, such as through a 
        web service. 
  '
  tag 'java', 'jre', 'java 8'
  tag :score, '5.3'
  ref 'http://www-01.ibm.com/support/docview.wss?uid=swg1IJ04042'

  only_if do
    os.aix?
  end

  describe command('/usr/bin/lslpp -Lqc Java8_64.jre') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end

  describe command('/usr/bin/lslpp -Lqc Java8_64.sdk') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end

  describe command('/usr/bin/lslpp -Lqc Java8.jre') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end

  describe command('/usr/bin/lslpp -Lqc Java8.sdk') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end
end

