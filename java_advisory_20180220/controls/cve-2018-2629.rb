# encoding: utf-8
# copyright: 2018, eNFence GmbH

title 'java_advisory_20180220'

control 'CVE-2018-2629' do
  impact 0.53
  title 'An unspecified vulnerability related to the Java SE JGSS component could allow an unauthenticated attacker to cause no confidentiality impact, high integrity impact, and no availability impact.'
  desc 'Vulnerability in the Java SE, Java SE Embedded, JRockit component 
        of Oracle Java SE (subcomponent: JGSS). Supported versions that 
        are affected are Java SE: 6u171, 7u161, 8u152 and 9.0.1; Java SE 
        Embedded: 8u151; JRockit: R28.3.16. Difficult to exploit vulnerability 
        allows unauthenticated attacker with network access via multiple 
        protocols to compromise Java SE, Java SE Embedded, JRockit. Successful 
        attacks require human interaction from a person other than the attacker. 
        Successful attacks of this vulnerability can result in unauthorized creation, 
        deletion or modification access to critical data or all Java SE, Java SE 
        Embedded, JRockit accessible data. Note: This vulnerability applies to client 
        and server deployment of Java. This vulnerability can be exploited through 
        sandboxed Java Web Start applications and sandboxed Java applets. It can also 
        be exploited by supplying data to APIs in the specified Component without 
        using sandboxed Java Web Start applications or sandboxed Java applets, such as 
        through a web service.
  '
  tag 'java', 'jre', 'java 8'
  tag :score, '5.3'
  ref 'http://www-01.ibm.com/support/docview.wss?uid=swg22012965'

  only_if do
    os.aix?
  end

  describe command('/usr/bin/lslpp -Lqc Java8_64.jre') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end

  describe command('/usr/bin/lslpp -Lqc Java8_64.sdk') do
    its('stdout') { should_not match(/:8\.0\.0\.[0-4]/) }
    its('stdout') { should_not match(/:8\.0\.0\.50/) }
  end
end

