# encoding: utf-8
# copyright: 2017, The Authors

title 'ntp_advisory11'

control 'CVE-2018-12327' do
  impact 0.59
  title 'CVE-2018-12327'
  desc ' NTP is vulnerable to a stack-based buffer overflow, caused 
        by improper bounds checking by ntpq and ntpdc. By sending an overly 
        long string argument, a local attacker could overflow a buffer and 
        execute arbitrary code on the system with elevated privileges or 
        cause the application to crash.
  '

  tag 'ntp', 'aix', 'aix53', 'aix61', 'aix71', 'aix72'
  tag :score, '5.9'
  ref 'http://aix.software.ibm.com/aix/efixes/security/ntp_advisory11.asc'

  only_if do
    os.aix?
  end

  describe command('/usr/bin/lslpp -Lqc ntp.rte') do
    its('stdout') { should_not match(/:7\.4\.2\.810[0-9]:/) }
  end

  if command('/usr/bin/lslpp -Lqc ntp.rte').stdout.match(/:7\.4\.2\.8110:/)
    describe command('/usr/sbin/emgr -l') do
      its('stdout') { should match(/IJ10280s3b/) }
    end
  end
end
