# encoding: utf-8
# copyright: 2017, The Authors

title 'itds_advisory2'

control 'CVE-2018-1447' do
  impact 0.51
  title 'CVE-2018-1447'
  desc 'The GSKit CMS KDB logic fails to salt the hash function 
        resulting in weaker than expected protection of passwords. A weak 
        password may be recovered. Note: After update the customer should 
        change password to ensure the new password is stored more securely. 
        Products should encourage customers to take this step as a high 
        priority action.
  '

  tag 'aix'
  tag 'ldap', 'itds', 'isds', 'gskit'
  tag :score, '5.1'
  ref 'https://aix.software.ibm.com/aix/efixes/security/itds_advisory2.asc'

  only_if do
    os.aix?
  end

  describe command('/usr/bin/lslpp -Lqc idsldap.srvbase64bit63.rte') do
    its('stdout') { should_not match(/:6\.3\.0\.[0-9]:/) }
    its('stdout') { should_not match(/:6\.3\.0\.[1-3][0-9]:/) }
    its('stdout') { should_not match(/:6\.3\.0\.4[0-8]:/) }
  end

  describe command('/usr/bin/lslpp -Lqc idsldap.cltbase63.rte') do
    its('stdout') { should_not match(/:6\.3\.0\.[0-9]:/) }
    its('stdout') { should_not match(/:6\.3\.0\.[1-3][0-9]:/) }
    its('stdout') { should_not match(/:6\.3\.0\.4[0-8]:/) }
  end
end
