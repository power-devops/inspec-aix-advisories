# encoding: utf-8
# copyright: 2017, The Authors

title 'openssl_advisory31'

control 'CVE-2019-1547' do
  impact 0.55
  title 'CVE-2019-1547'
  desc 'OpenSSL could allow a local authenticated attacker to obtain
        sensitive information, caused by the ability to construct an EC group
        missing the cofactor using explicit parameters instead of using a 
        named curve. An attacker could exploit this vulnerability to obtain 
        full key recovery during an ECDSA signature operation. 
  '

  tag 'openssl'
  tag :score, '5.5'
  ref 'https://aix.software.ibm.com/aix/efixes/security/openssl_advisory31.asc'

  only_if do
    os.aix?
  end

  describe command('/usr/bin/lslpp -Lqc openssl.base') do
    its('stdout') { should_not match(/:1\.0\.2\.[5-9][0-9][0-9]:/) }
    its('stdout') { should_not match(/:1\.0\.2\.1[0-9][0-9][0-9][0-9]:/) }
  end

  describe command('/usr/bin/lslpp -Lqc openssl.base') do
    its('stdout') { should_not match(/:20\.13\.102\.1[0-9][0-9][0-9]:/) }
    its('stdout') { should_not match(/:20\.1[45]\.102\.[0-9]/) }
    its('stdout') { should_not match(/:20\.16\.102\.[0-9]:/) }
    its('stdout') { should_not match(/:20\.16\.102\.[1-9][0-9]:/) }
    its('stdout') { should_not match(/:20\.16\.102\.[1-9][0-9][0-9]:/) }
    its('stdout') { should_not match(/:20\.16\.102\.1[0-9][0-9][0-9]:/) }
  end
end
